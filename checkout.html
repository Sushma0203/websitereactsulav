<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Harati Maa Jyasa Pasa</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="checkout-styles.css">
</head>

<body>

    <!-- NAVBAR -->
    <header class="navbar">
        <div class="nav-inner">
            <div class="logo">
                <img src="img/s.png" alt="Harati Gold Logo" id="logoZoom">
            </div>

            <input type="checkbox" id="menu-toggle">
            <label for="menu-toggle" class="hamburger">
                <i class="fas fa-bars"></i>
            </label>

            <nav class="nav-links">
                <a href="index.html">Home</a>
                <a href="about.html">About</a>
                <a href="shop.html">Shop Now</a>
                <a href="design.html">Designs</a>
                <a href="services.html">Services</a>
                <a href="faq.html">FAQ</a>
                <a href="contact.html">Contact</a>
                <a href="cart.html">Book</a>
                <a href="reviews.html">Review</a>
                <a href="login.html" class="admin-btn">Login</a>
            </nav>

            <div class="nav-datetime" id="navDateTime"></div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <main>

        <!-- HERO -->
        <div class="checkout-hero">
            <div class="hero-content">
                <h1>Checkout</h1>
                <p>Fill your details to complete booking</p>
            </div>
        </div>

        <!-- FORM -->
        <section class="checkout-section">
            <div class="checkout-container">
                <form class="checkout-form" id="checkout-form">
                    <label>Name</label>
                    <input type="text" name="name" id="name" placeholder="Enter your name" required>

                    <label>Email</label>
                    <input type="email" name="email" id="email" placeholder="Enter your email" required>

                    <label>Phone</label>
                    <input type="tel" name="phone" id="phone" placeholder="Enter your phone number" required>

                    <label>Address</label>
                    <textarea name="address" id="address" placeholder="Enter your shipping address" required></textarea>

                    <label>Payment Method</label>
                    <select name="payment_method" id="payment_method" required>
                        <option value="qr">QR Payment (Scan in Cart)</option>
                        <option value="cod">Cash on Delivery</option>
                    </select>

                    <div id="screenshot-group">
                        <label>Payment Screenshot (Required for QR)</label>
                        <input type="file" name="payment_screenshot" id="payment_screenshot" accept="image/*">
                        <p style="font-size: 12px; color: #7c6837; margin-top: 5px;">Please upload the transaction
                            screenshot of your Rs. 5,000 booking fee.</p>
                    </div>

                    <h3>Total Amount: <span id="checkout-total" style="color: #d4af37;">Rs. 0</span></h3>

                    <button type="submit" class="checkout-btn">Place Booking</button>
                </form>
            </div>
        </section>

    </main>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-content">
            <div>
                <p class="footer-title">Harati Maa Jyasa Pasa</p>
                <p class="footer-copy">© 2025 All Rights Reserved</p>
            </div>

            <div class="footer-nav">
                <a href="index.html">Home</a>
                <a href="about.html">About</a>
                <a href="shop.html">Shop</a>
                <a href="design.html">Designs</a>
                <a href="services.html">Services</a>
                <a href="faq.html">FAQ</a>
                <a href="contact.html">Contact</a>
                <a href="cart.html">Book</a>
                <a href="reviews.html">Review</a>
            </div>

            <div class="footer-social">
                <a href="mailto:haratimaa@gmail.com" title="Email Us">
                    <i class="fas fa-envelope"></i>
                </a>
                <a href="https://www.facebook.com/haratimaajyasapasa" target="_blank">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="https://www.instagram.com/haratima_jp/" target="_blank">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://www.tiktok.com/@haratima_jp?_r=1&_t=ZT-92SExMqDllO" target="_blank">
                    <i class="fab fa-tiktok"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- LOGO ZOOM MODAL -->
    <div class="logo-modal" id="logoModal">
        <span class="logo-close" id="closeLogo">&times;</span>
        <img src="img/s.png" alt="Harati Logo Zoomed">
    </div>

    <!-- Load Data & Scripts -->
    <script src="cart-data.js"></script>
    <script src="main.js"></script>

    <script>
        // Load subtotal from CartManager
        function initCheckout() {
            const items = CartManager.getCart();
            const goldRate = cartData.rates.gold;
            const total = CartManager.calculateTotal(items, goldRate);

            document.getElementById('checkout-total').innerText = 'Rs. ' + total.toLocaleString(undefined, { minimumFractionDigits: 2 });
        }

        // Payment method toggle
        document.getElementById('payment_method').addEventListener('change', function () {
            const group = document.getElementById('screenshot-group');
            const screenshot = document.getElementById('payment_screenshot');
            if (this.value === 'qr') {
                group.style.display = 'block';
                screenshot.required = true;
            } else {
                group.style.display = 'none';
                screenshot.required = false;
            }
        });

        // Form Validation and Submission
        document.getElementById('checkout-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const address = document.getElementById('address').value.trim();
            const method = document.getElementById('payment_method').value;
            const screenshot = document.getElementById('payment_screenshot');

            // Email validation
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailPattern.test(email)) {
                alert("❌ Please enter a valid email address.");
                return;
            }

            // Phone validation
            const phonePattern = /^9\d{9}$/;
            if (!phonePattern.test(phone)) {
                alert("❌ Please enter a valid 10-digit phone number starting with 9.");
                return;
            }

            if (method === 'qr' && !screenshot.files.length) {
                alert("❌ Please upload the payment screenshot for QR payment.");
                return;
            }

            // Booking confirmation
            const confirmBooking = confirm(
                "⚠️ Please note: The amount shown is for booking purposes only. " +
                "The final price may vary due to daily gold rate, purity, making charges, and taxes.\n\n" +
                "Do you want to confirm your booking?"
            );

            if (confirmBooking) {
                alert("✅ Booking successfully placed! (Static Demo)");
                CartManager.clearCart();
                window.location.href = 'index.html';
            } else {
                alert("❌ Booking cancelled.");
            }
        });

        // Initialize
        initCheckout();
        document.getElementById('payment_method').dispatchEvent(new Event('change'));
    </script>

</body>

</html>